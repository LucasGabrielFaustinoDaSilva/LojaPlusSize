@model List<LojaPlusSize.Models.CarrinhoItem>

@{
  ViewData["Title"] = "Meu Carrinho";
}

<div class="container mt-4">
  <div class="row">
    <div class="col-12">
      <h1 class="section-title">üõí Meu Carrinho</h1>
    </div>
  </div>

  @if (TempData["Sucesso"] != null)
  {
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      @TempData["Sucesso"]
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  }

  @if (!Model.Any())
  {
    <div class="text-center py-5">
      <i class="fas fa-shopping-cart fa-4x mb-4" style="color: var(--rosa-terroso);"></i>
      <h3 class="mb-3">Seu carrinho est√° vazio</h3>
      <p class="text-muted mb-4">Descubra nossas pe√ßas incr√≠veis</p>
      <a href="@Url.Action("Index", "Produto")" class="btn btn-primary-custom btn-lg">
        Explorar Cole√ß√£o
      </a>
    </div>
  }
  else
  {
    <div class="row">
      <div class="col-lg-8">
        @foreach (var item in Model)
        {
          <div class="product-card mb-4">
            <div class="row g-0">
              <div class="col-md-3">
                <img src="@item.ImagemUrl" class="product-image" alt="@item.Nome">
              </div>
              <div class="col-md-6">
                <div class="card-body p-4">
                  <h5 class="card-title fw-bold">@item.Nome</h5>
                  <p class="text-muted mb-2">Tamanho: @item.Tamanho</p>
                  <p class="h5 text-success mb-3">R$ @item.Preco.ToString("N2")</p>

                  <div class="d-flex align-items-center">
                    <form method="post" asp-action="AtualizarQuantidade" class="me-3">
                      <input type="hidden" name="produtoId" value="@item.ProdutoId">
                      <input type="hidden" name="tamanho" value="@item.Tamanho">
                      <div class="input-group" style="width: 140px;">
                        <button type="submit" name="quantidade" value="@(item.Quantidade - 1)"
                          class="btn btn-outline-secondary">-</button>
                        <span class="input-group-text bg-white">@item.Quantidade</span>
                        <button type="submit" name="quantidade" value="@(item.Quantidade + 1)"
                          class="btn btn-outline-secondary">+</button>
                      </div>
                    </form>

                    <form method="post" asp-action="Remover">
                      <input type="hidden" name="produtoId" value="@item.ProdutoId">
                      <input type="hidden" name="tamanho" value="@item.Tamanho">
                      <button type="submit" class="btn btn-link text-danger p-0 ms-3">
                        <i class="fas fa-trash"></i> Remover
                      </button>
                    </form>
                  </div>
                </div>
              </div>
              <div class="col-md-3 d-flex align-items-center justify-content-end p-4">
                <span class="h5 fw-bold">R$ @item.Total.ToString("N2")</span>
              </div>
            </div>
          </div>
        }

        <div class="text-start mt-4">
          <form method="post" asp-action="Limpar">
            <button type="submit" class="btn btn-outline-danger">
              <i class="fas fa-trash"></i> Limpar Carrinho
            </button>
          </form>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="product-card p-4">
          <h5 class="fw-bold mb-4">Resumo do Pedido</h5>

          <div class="d-flex justify-content-between mb-3">
            <span>Subtotal (@Model.Sum(x => x.Quantidade) itens):</span>
            <span class="fw-bold">R$ @ViewBag.Total.ToString("N2")</span>
          </div>

          <div class="d-flex justify-content-between mb-3">
            <span>Frete:</span>
            <span class="text-success">Gr√°tis</span>
          </div>

          <hr>

          <div class="d-flex justify-content-between mb-4">
            <span class="h5">Total:</span>
            <span class="h4 text-success">R$ @ViewBag.Total.ToString("N2")</span>
          </div>

          <button class="btn btn-primary-custom w-100 btn-lg">
            <i class="fas fa-lock"></i> Finalizar Compra
          </button>

          <div class="text-center mt-3">
            <a href="@Url.Action("Index", "Produto")" class="text-decoration-none">
              <i class="fas fa-arrow-left"></i> Continuar Comprando
            </a>
          </div>
        </div>
      </div>
    </div>
  }
</div>